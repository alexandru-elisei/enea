{{!
    @template mod_enea/search_results
}}

<br>
<h3 class="text">{{# str}} searchresults, mod_enea {{/ str}}</h3>
<br>
<p class="text-left"> {{# str}} selectlessons, mod_enea {{/ str}}</p>

<form id="search-results-form">
    <br>
    <div class="form-row text-left lead">
        <dt><u>{{# str}} prerequisites, mod_enea {{/ str}}</u></dt>
    </div>

    {{< mod_enea/course_list_heading}}
    {{$ title}} {{# str}} title, mod_enea {{/ str}} {{/ title}}
    {{$ time}}  {{# str}} time, mod_enea {{/ str}}  {{/ time}}
    {{/ mod_enea/course_list_heading}}

    {{# prereq}}
    {{< mod_enea/course_list_row}}
    {{$ elt_name}}{{ name }}{{/ elt_name}}
    {{$ course_title}}{{ title }}{{/ course_title}}
    {{$ course_link}}{{ link }}{{/ course_link}}
    {{$ course_time}}{{ time }}{{/ course_time}}
    {{/ mod_enea/course_list_row}}
    {{/ prereq}}

    <br>
    <br>
    <div class="form-row text-left lead">
        <dt><u>{{# str}} recommendedlessons, mod_enea {{/ str}}</u></dt>
    </div>

    {{< mod_enea/course_list_heading}}
    {{$ title}} {{# str}} title, mod_enea {{/ str}} {{/ title}}
    {{$ time}}  {{# str}} time, mod_enea {{/ str}}  {{/ time}}
    {{/ mod_enea/course_list_heading}}

    {{# recommended}}
    {{< mod_enea/course_list_row}}
    {{$ elt_name}}{{ name }}{{/ elt_name}}
    {{$ course_title}}{{ title }}{{/ course_title}}
    {{$ course_link}}{{ link }}{{/ course_link}}
    {{$ course_time}}{{ time }}{{/ course_time}}
    {{/ mod_enea/course_list_row}}
    {{/ recommended}}

    <br>
    <br>
    <div class="form-row text-left lead">
        <dt><u>{{# str}} followuplessons, mod_enea {{/ str}}</u></dt>
    </div>

    {{< mod_enea/course_list_heading}}
    {{$ title}} {{# str}} title, mod_enea {{/ str}} {{/ title}}
    {{$ time}}  {{# str}} time, mod_enea {{/ str}}  {{/ time}}
    {{/ mod_enea/course_list_heading}}

    {{# postreq}}
    {{< mod_enea/course_list_row}}
    {{$ elt_name}}{{ name }}{{/ elt_name}}
    {{$ course_title}}{{ title }}{{/ course_title}}
    {{$ course_link}}{{ link }}{{/ course_link}}
    {{$ course_time}}{{ time }}{{/ course_time}}
    {{/ mod_enea/course_list_row}}
    {{/ postreq}}

    <div style="display: none">
    {{# cmid}}
    <input name="cmid" type="hidden" value="{{ . }}">
    {{/ cmid}}
    {{# id}}
    <input name="id" type="hidden" value="{{ . }}">
    {{/ id}}
    <input name="stage" type="hidden" value="2">
    <input name="dependencies_json" type="hidden" value="{{ dependencies }}">
    </div>

    <br>
    </div>
    <div class="form-inline felement data-fieldtype="group"">
        <div class="form-group fitem">
            <input type="submit" class="btn btn-primary" name="finishbutton" value="{{# str}} finish, mod_enea {{/ str}}">
        </div>
        <input class="btn btn-secondary" type="reset" name="clearbutton" value="{{# str}} clear, mod_enea {{/ str}}">
    </div>
</form>

{{# js}}
    require(['jquery'], function($) {
        $('document').ready(function() {
            {{# dependencies}}
            $("[name='{{ depname }}']").prop('disabled', true);

            {{# deps }}
            $("[name='{{ . }}']").change(function() {
                if (this.checked) {
                    var all_deps_checked = true;

                    {{# deps}}
                    if (!$("[name='{{ . }}'").prop('checked') || $("[name='{{ .  }}'").prop('disabled')) {
                        all_deps_checked = false;
                    }
                    {{/ deps}}

                    if (all_deps_checked) {
                        $("[name='{{ depname }}']").prop('disabled', false);
                    } else {
                        $("[name='{{ depname }}']").prop('disabled', true);
                    }
                } else {
                    $("[name='{{ depname }}']").prop('disabled', true);
                }
            });
            {{/ deps }}
            {{/ dependencies}}

            $('#search-results-form').on('reset', function() {
                setTimeout(function() {
                    {{# dependencies}}
                    $("[name='{{ depname }}']").prop('disabled', true);
                    {{/ dependencies}}
                });
            });
        });
    });
{{/ js}}
